---
layout: post
title:  "JAVA JSP2"
date:   2020-01-05
author: LeeKiJong
categories: JSP
comments : true
tags: JAVA JSP
cover:  "/assets/java.jpg"
---


<hr>
<h2>세션</h2>
: 쿠키와 비슷한 의미이나, 쿠키와 달리 클라이언트의 특정 위치에 저장되는 것이 아니라, 서버상에 객체로 존재 한다.  
따라서 세션은 서버에서만 접근이 가능하며 보안이 좋고, 저장할 수 있는 데이터에 한계가 없다.

<h4>세션 문법</h4>
- 세션은 클라이언트의요청이 발생하면 자동 생성 된다. 그리고 session이라는 내부 객체를 지원하여 세션의 속성을 설정 할 수 있다.  
![12](https://user-images.githubusercontent.com/52438368/71777787-5b5d9800-2fe8-11ea-860c-d9341f1ad704.PNG)
<h5>세션 관련 메소드</h5>
- setAttribute(): 세션에 데이터를 저장한다.
- getAttribute(): 세션에 데이터를 얻는다.
- getAttributeNames(): 세션에 저장되어 있는 모든 데이터의 이름(유니크한 키값)을 얻는다.
- getid(): 자동 생셩된 세션의 유니크한 아이디를 얻는다.
- isNew(): 세션이 최초 생성되었는지, 이전에 생성된 세션인지를 구분한다.
- getMaxInactiveInterval(): 세션의 유효시간을 얻는다. 가장 최근 요청시점을 기준으로 카운트 된다.
- removeAttribute(): 세션에서 특정 데이터를 제거한다.
- Invalidate(): 세션의 모든 데이터를 삭제한다.
Ex)  
login.html
```html
<form  action = "loginOK.jsp" method = "post">
	아이디: <input type = "text" name = "id" size ="10"><br/> 
	비밀번호: <input type = "password" name ="pw" size = "10"> <br/>
	<input type = "submit" value ="로그인">
	</form>
```
loginOK.jsp
```html
<%!
	String id, pw;
%>

<%
	id = request.getParameter("id");
	pw = request.getParameter("pw");
	
	if(id.equals("abcde") && pw.equals("12345")){
		session.setAttribute("id", id);
		response.sendRedirect("welcome.jsp");
	}else{
		response.sendRedirect("login.html");
	}

%>
```
logout.jsp
```html
<% 
Enumeration enumeration = session.getAttributeNames();
while(enumeration.hasMoreElements()){
	String sName = enumeration.nextElement().toString();
	String sValue = session.getAttribute(sName).toString();
	
	if(sValue.equals("abcde")) session.removeAttribute(sName);
}
		
	response.sendRedirect("sessiontest.jsp");
%>
```
sessionget.jsp
```html
<%
	Object obj1 = session.getAttribute("mySessionName");
	String mySessionName = (String)obj1;
	out.println(mySessionName + "<br/>");
	
	Object obj2 = session.getAttribute("myNum");
	Integer myNum = (Integer)obj2;
	out.println(myNum + "<br/>");
	
	out.println("************************** <br/>");
	
	String sName;
	String sValue;

	Enumeration enumeration = session.getAttributeNames();
	while(enumeration.hasMoreElements()){
		sName = enumeration.nextElement().toString();
		sValue = session.getAttribute(sName).toString();
		out.println("sName: " + sName +  "</br>");
		out.println("sValue: " + sValue + "</br>");
	}
	
	out.println("************************** <br/>");
	
	String sessionID = session.getId();
	out.println("sessionID: " + sessionID + "<br/>");
	int sessionInter = session.getMaxInactiveInterval();
	out.println("sessionInter: " + sessionInter + "<br/>");

	out.println("************************** <br/>");
	
	session.removeAttribute("mySessionName");
	Enumeration enumeration1 = session.getAttributeNames();
	
	while(enumeration1.hasMoreElements()){
		sName = enumeration1.nextElement().toString();
		sValue = session.getAttribute(sName).toString();
		out.println("sName: " + sName +  "</br>");
		out.println("sValue: " + sValue + "</br>");
	
	}
	
	out.println("************************** <br/>");
	
	session.invalidate();
	if(request.isRequestedSessionIdValid()){
		out.println("session valid");
	}else{
		out.println("session invalid");
	}
%>
```
sessioninit.jsp
```html
<%
	session.setAttribute("mySessionName", "mySessionData");
	session.setAttribute("myNum", 12345);
%>
<a href = "sessionget.jsp">session get</a>
```
sessiontest.jsp
```html
<%
Enumeration enumeration = session.getAttributeNames();
int i=0;
while(enumeration.hasMoreElements()){
	i++;
	String sName = enumeration.nextElement().toString();
	String sValue = session.getAttribute(sName).toString();
	
	if(sValue.equals("abcde")) session.removeAttribute(sName);

	out.println("sName: " + sName + "<br/>");
	out.println("sValue: " + sValue + "<br/>");
}
	if(i==0)out.println("해당 세션이 삭제 되었습니다.");
%>
```
welcome.jsp
```html
	<%
		Enumeration enumeration = session.getAttributeNames();
		while(enumeration.hasMoreElements()){
			String sName = enumeration.nextElement().toString();
			String sValue = session.getAttribute(sName).toString();
			
			if(sValue.equals("abcde")) out.println(sValue + "님 안녕하세요" + "<br/>");
		}
	%>
	
	<a href="logout.jsp">로그아웃</a>
```

<hr>
<h2>예외 페이지</h2>

