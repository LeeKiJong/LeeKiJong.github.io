---
layout: post
title:  "JSP게시판 필기용(코드 단축)"
date:   2020-07-01
author: LeeKiJong
categories: Programming
comments : true
tags: JAVA Programming
cover:  "/assets/java.jpg"
---

```sql
create table mvc_board(
    bId NUMBER(4) PRIMARY KEY,
    bName VARCHAR2(20),
    bTitle VARCHAR2(100),
    bContent VARCHAR(300),
    bDate DATE DEFAULT SYSDATE,
    bHit NUMBER(4) DEFAULT 0,
    bGroup NUMBER(4),
    bStep NUMBER(4),
    bIndent NUMBER(4)
);
commit;
```
<hr>
<h4>FrontController</h4>
: 클라이언트의 요청을 받는 역할을 하는 Controller.  
<h5>FrontController.java</h5>
```java
package com.javalec.jsp_homepage.frontcontroller;

import java.io.IOException;
import java.io.UnsupportedEncodingException;

import javax.servlet.RequestDispatcher;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import com.javalec.jsp_homepage.command.BContentCommand;
import com.javalec.jsp_homepage.command.BDeleteCommand;
import com.javalec.jsp_homepage.command.BListCommand;
import com.javalec.jsp_homepage.command.BModifyCommand;
import com.javalec.jsp_homepage.command.BReplyCommand;
import com.javalec.jsp_homepage.command.BReplyViewCommand;
import com.javalec.jsp_homepage.command.BWriteCommand;
import com.javalec.jsp_homepage.command.Command;
import com.javalec.jsp_homepage.command.JoinCommand;
import com.javalec.jsp_homepage.command.LoginCommand;
import com.javalec.jsp_homepage.command.LogoutCommand;
import com.javalec.jsp_homepage.command.ModifyCommand;

@WebServlet("*.do")		/* URL 패턴 */
public class FrontController extends HttpServlet {
	private static final long serialVersionUID = 1L;
	public FrontController() {
		super();
	}
	protected void doGet(HttpServletRequest request, HttpServletResponse response)
			throws ServletException, IOException {
		actionDo(request, response);
	}
	protected void doPost(HttpServletRequest request, HttpServletResponse response)
			throws ServletException, IOException {
		actionDo(request, response);
	}
	private void actionDo(HttpServletRequest request, HttpServletResponse response)
			throws ServletException, IOException {

		request.setCharacterEncoding("UTF-8");				//jsp 한글화 적용.

		String viewPage = null;
		Command command = null;
		
		String uri = request.getRequestURI();
		String conPath = request.getContextPath();
		String com = uri.substring(conPath.length());		//Request를 위한 선언

		if (com.equals("/login.do")) {						
			viewPage = "login.jsp";							
		} else if (com.equals("/loginOK.do")) {
			command = new LoginCommand();
			command.execute(request, response);
			viewPage = "login.do";
		} else if (com.equals("/join.do")) {
			viewPage = "join.jsp";
		} else if (com.equals("/joinOK.do")) {
			command = new JoinCommand();
			command.execute(request, response);
			viewPage = "login.do";
		} else if (com.equals("/main.do")) {
			viewPage = "main.jsp";
		} else if (com.equals("/logout.do")) {
			command = new LogoutCommand();
			command.execute(request, response);
			viewPage = "login.do";
		} else if (com.equals("/modify.do")) {
			viewPage = "modify.jsp";
		} else if (com.equals("/modifyOK.do")) {
			command = new ModifyCommand();
			command.execute(request, response);
			viewPage = "login.do";
		} else if (com.equals("/write_view.do")) {
			viewPage = "write_view.jsp";
		} else if (com.equals("/write.do")) {
			command = new BWriteCommand();
			command.execute(request, response);
			viewPage = "list.do";
		} else if (com.equals("/list.do")) {
			command = new BListCommand();
			command.execute(request, response);
			viewPage = "list.jsp";
		} else if (com.equals("/content_view.do")) {
			command = new BContentCommand();
			command.execute(request, response);
			viewPage = "content_view.jsp";
		} else if (com.equals("/Bmodify.do")) {
			viewPage = "Bmodify.jsp";
		} else if (com.equals("/BmodifyOK.do")) {
			command = new BModifyCommand();
			command.execute(request, response);
			viewPage = "list.do";
		} else if (com.equals("/delete.do")) {
			command = new BDeleteCommand();
			command.execute(request, response);
			viewPage = "list.do";
		} else if (com.equals("/reply_view.do")) {
			command = new BReplyViewCommand();
			command.execute(request, response);
			viewPage = "reply_view.jsp";
		} else if (com.equals("/reply.do")) {
			command = new BReplyCommand();
			command.execute(request, response);
			viewPage = "list.do";
		}

		RequestDispatcher dispatcher = request.getRequestDispatcher(viewPage);		//login.do페이지를 요청하면 아래 내용을 실행 후 viewPage에 저장된 페이지로 띄운다.
		dispatcher.forward(request, response);										//forward를 통해

	}
}
```
<hr>
<h4>View</h4>
: 클라이언트의 요청에 대해서 FrontController에서 작업을 분기하고, 해당 Command클래스가 작동하여 DAO를 이용한 데이터 베이스 작업을 합니다.  
DAO클래스의 결과물로 DTO객체가 View(.jsp페이지)로 전달되며, View에서는 클라이언트의 요청에 대한 응답으로 화면(UI)을 구성하여 출력.  
<hr>
<h4>글 목록 페이지 만들기</h4>
![14](https://user-images.githubusercontent.com/52438368/73166819-f5bd8100-4139-11ea-8909-2c4a8a72c538.PNG)  
<h5>list.jsp</h5>
```html
<%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>			<!-- JSTL(JavaServer Pages Standard Tag Library) -->
<link rel="stylesheet" href="css_folder/assets/css/main.css" />			<!-- css 적용 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=EUC-KR">
<title>Board</title>
</head>
<body>
	<c:set var="Modify_Result" value="${Modify_Result}" />				<!-- JSTL의 변수 선언 법(<c:set var = "변수명" value = "변수값 " />) -->
	<c:choose>															<!-- JSTL의 스위치문 -->
		<c:when test="${Modify_Result eq 1}">							<!-- (eq = equal), (ne = not equal) -->
			<script language="javascript">								//이 구간은 javascript 언어를 사용하겠다라고 명시 
				alert("Modify Success");								//alert(알림)
			</script>
			<c:remove var="Modify_Result" />							<!-- JSTL의 변수 삭제 법 -->
		</c:when>
		<c:when test="${Modify_Result eq 0}">
			<script language="javascript">
				alert("권한이 없습니다.");
			</script>
			<c:remove var="Modify_Result" />
		</c:when>
	</c:choose>															<!-- Modify_Result(수정 결과가 1이라면 수정 성공 아니라면 수정 실패) -->

	<c:set var="Delete_Result" value="${Delete_Result}" />				<!-- Delete_Result(삭제 결과가 1이라면 삭제 성공 아니라면 삭제 실패) -->
	<c:choose>
		<c:when test="${Delete_Result eq 1}">
			<script language="javascript">
				alert("Delete Success");
			</script>
			<c:remove var="Delete_Result" />
		</c:when>
		<c:when test="${Delete_Result eq 0}">
			<script language="javascript">
				alert("권한이 없습니다.");
			</script>
			<c:remove var="Delete_Result" />
		</c:when>
	</c:choose>
	<section id="four" class="main">
	<div class="container">
		<div class="content">
			<section>
			<h4>게시판</h4>
			<div class="table-wrapper">
				<table class="alt">
					<thead>
						<tr>
							<th>No.</th>
							<th>Writer</th>
							<th>Title</th>
							<th>Date</th>
							<th>Hit</th>
						</tr>
					</thead>
					<tbody>
						<c:forEach items="${list}" var="dto">			<!-- JSTL의 반복문(${list}의 리스트를 dto라는 변수라는 이름으로 사용) -->
							<tr>
								<td>${dto.bId}</td>
								<td>${dto.bName}</td>
								<td><c:forEach begin="1" end="${dto.bIndent}">-</c:forEach>
									<a href="content_view.do?bId=${dto.bId}">${dto.bTitle}</a></td>		<!-- bIdㅇ의 값을 같이 보낸다. -->
								<td>${dto.bDate}</td>
								<td>${dto.bHit}</td>
							</tr>
						</c:forEach>
						<tr>
							<td colspan="5"><a href="write_view.do">글작성</a>							<!-- <a href> = 주소 이동 -->
								&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="logout.do">로그아웃</a></td>
						</tr>
					</tbody>
				</table>
			</div>
			</section>
		</div>
	</div>
	</section>
</body>
</html>
```
<hr>
<h4>글 내용 보기 페이지 만들기</h4>
![15](https://user-images.githubusercontent.com/52438368/73176485-e5b09c00-414f-11ea-8cb1-f23d50cbdd97.PNG)  
<h5>content_view.jsp</h5>
```html

```
<hr>
<h4>글 내용 수정 페이지 만들기</h4>
![16](https://user-images.githubusercontent.com/52438368/73177604-c9fac500-4152-11ea-916b-10af49702a35.PNG)  
<hr>
<h4>글 내용 삭제 페이지 만들기</h4>
![17](https://user-images.githubusercontent.com/52438368/73177687-f878a000-4152-11ea-8c14-b6c3850621d6.PNG)  
<hr>
<h4>글 답변 달기</h4>
![18](https://user-images.githubusercontent.com/52438368/73178161-0975e100-4154-11ea-9627-f26c9dc1849b.PNG)  
```html

```
<hr>
<h4>글 작성 페이지</h4>
```html

```
<hr>
<h4>DAO</h4>
<h5>BDao.java</h5>
```java


```
<hr>
<h4>DTO</h4>
<h5>BDto.java</h5>
```java

```
<hr>
<h4>COMMAND</h4>
<h5>BCommand.java</h5>
```java

```
<hr>
<h5>BContentCommand.java</h5>
```java

```
<hr>
<h5>BDeleteCommand.java</h5>
```java

```
<hr>
<h5>BListCommand.java</h5>
```java

```
<hr>
<h5>BModifyCommand.java</h5>
```java

```
<hr>
<h5>BReplyCommand.java</h5>
```java


```
<hr>
<h5>BReplyViewCommand.java</h5>
```java


```
<hr>
<h5>BWriteCommand.java</h5>
```java


```
